
<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Jruif&#39;s Blog | 路漫漫其修远兮，吾将上下而求索</title>
  <meta name="author" content="jruif">
  
  <meta name="description" content="jruif,jruif博客,Javascript,css3,nodejs">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Jruif&#39;s Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Jruif&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/js/jruif.css" media="screen" type="text/css">
</head>


<body>
  <header id="header" class="inner clearfix"><a href="/" class="alignleft">
	<img class="avatar" src="http://ww2.sinaimg.cn/large/7a0338aegw1ej12rnn2lyj2028028t8j.jpg" title="Jruif&#39;s Blog | 路漫漫其修远兮，吾将上下而求索">
</a>
<div class="header-myinfo">
	<h1 class="header-title">Jruif&#39;s Blog</h1>
	 
	<span class="header-subtitle">路漫漫其修远兮，吾将上下而求索</span>
</div>
<nav id="main-nav" class="alignright clearfix">
  <ul class="clearfix">
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/archives">分类</a></li>
    
      <li><a href="/resume">About</a></li>
    
  </ul>
</nav></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  
    
  

<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-11-08T07:50:04.000Z"><a href="/2014-11/jquery中ready和和DOM的load事件/">2014 11月 8</a></time>
      
      
  
    <h1 class="title"><a href="/2014-11/jquery中ready和和DOM的load事件/">jquery中ready和和DOM的load事件</a></h1>
  

    </header>
    <div class="entry">
      
        <p>jquery中ready和和DOM的load事件</p>
<p>常用的文档加载方法有以下三种（两种jquery的方法）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{</div><div class="line">		<span class="comment">//todo</span></div><div class="line">});</div><div class="line">$(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{</div><div class="line">	<span class="comment">//todo</span></div><div class="line">});</div><div class="line"><span class="built_in">window</span>.load=<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{</div><div class="line">	<span class="comment">//todo</span></div><div class="line">};</div></pre></td></tr></table></figure>

<p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2014-11/jquery中ready和和DOM的load事件/#more" class="more-link">阅读全文 &gt;</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  

<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-10-30T16:48:34.000Z"><a href="/2014-10/运行grunt报错：Maximum-call-stack-size-exceeded的解决方案/">2014 10月 31</a></time>
      
      
  
    <h1 class="title"><a href="/2014-10/运行grunt报错：Maximum-call-stack-size-exceeded的解决方案/">运行grunt报错：Maximum call stack size exceeded的解决方案</a></h1>
  

    </header>
    <div class="entry">
      
        <p>这是我前两天晚上遇到的一个问题，之前没有碰见过，突然碰到了，让我很迷惑怎么调用的堆栈超过了限制，怎么都找不到问题的所在，只好一行一行的删除代码使用排除法，最后定位到是处理less文件的任务出了问题，最后终于在一个文档中找到了问题的所在：</p>
<p>You probably created an alias task with the same name as one of your regular tasks.<br>Example: </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">grunt.registerTask(<span class="string">'less'</span>, [<span class="string">'less:build'</span>]);</div></pre></td></tr></table></figure>

<p>should be </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">grunt.registerTask(<span class="string">'myless'</span>, [<span class="string">'less:build'</span>]);</div></pre></td></tr></table></figure>


<p>//中文：为什么我运行grunt得到一个 “Maximum call stack size exceeded”错误？</p>
<p>你可能创建了一个和常规任务相同名字的别名任务。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">grunt.registerTask(<span class="string">'less'</span>, [<span class="string">'less:build'</span>]);</div></pre></td></tr></table></figure>

<p>应该是</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">grunt.registerTask(<span class="string">'myless'</span>, [<span class="string">'less:build'</span>]);</div></pre></td></tr></table></figure>

<p>都是没仔细看文档的后果啊。</p>
<blockquote>
<p>欢迎加入<a href="http://shang.qq.com/wpa/qunwpa?idkey=a61d2af0241e8eb322e98f4a162e124606acf0b96ec06683fb67ddeb538ce0a4" target="_blank" rel="external">Javascript前端技术</a>，群号为:<a href="http://shang.qq.com/wpa/qunwpa?idkey=a61d2af0241e8eb322e98f4a162e124606acf0b96ec06683fb67ddeb538ce0a4" target="_blank" rel="external">85088298</a></p>
</blockquote>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  

<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-10-27T14:16:39.000Z"><a href="/2014-10/HTML-5-History-API的前生今世/">2014 10月 27</a></time>
      
      
  
    <h1 class="title"><a href="/2014-10/HTML-5-History-API的前生今世/">HTML 5 History API的&#39;前生今世&#39;</a></h1>
  

    </header>
    <div class="entry">
      
        <!-- MarkdownTOC -->

<ul>
<li><a href="#为什么介绍history-api-？">为什么介绍History API ？</a></li>
<li><a href="#浏览器支持">浏览器支持</a></li>
<li><a href="#使用history">使用History</a></li>
<li><a href="#demo示例">Demo示例</a><ul>
<li><a href="#demo-1：html-5-history-api-–-pushstate">Demo 1：HTML 5 History API – pushState</a></li>
<li><a href="#demo-2：html-5-history-api-–-replacestate">Demo 2：HTML 5 History API – replaceState</a></li>
</ul>
</li>
<li><a href="#总结">总结</a></li>
</ul>
<!-- /MarkdownTOC -->


<p>History是有趣的，不是吗？在之前的HTML版本中，我们对浏览历史记录的操作非常有限。我们可以来回使用可以使用的方法，但这就是一切我们能做的了。</p>
<p>但是，利用HTML 5的History API，我们可以更好的控制浏览器的历史记录了。例如：我们可以添加一条记录到历史记录的列表中，或者在没有刷新时，可以更新地址栏的URL。<br>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2014-10/HTML-5-History-API的前生今世/#more" class="more-link">阅读全文 &gt;</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  

<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-10-18T09:21:13.000Z"><a href="/2014-10/《黑客与画家》读书笔记/">2014 10月 18</a></time>
      
      
  
    <h1 class="title"><a href="/2014-10/《黑客与画家》读书笔记/">《黑客与画家》读书笔记</a></h1>
  

    </header>
    <div class="entry">
      
        <!-- MarkdownTOC -->

<ul>
<li><a href="#趋同性">趋同性</a></li>
<li><a href="#老员工与新人的关系">老员工与新人的关系</a></li>
<li><a href="#付出与回报守恒">付出与回报守恒</a></li>
<li><a href="#金钱不等于财富">金钱不等于财富</a></li>
<li><a href="#理解财富增长">理解财富增长</a></li>
<li><a href="#关注贫富分化">关注贫富分化</a></li>
<li><a href="#选择">选择</a></li>
<li><a href="#大公司">大公司</a></li>
<li><a href="#致富的要素">致富的要素</a></li>
<li><a href="#用户数量">用户数量</a></li>
<li><a href="#设计者的品味">设计者的品味</a></li>
<li><a href="#好的设计是一种再设计">好的设计是一种再设计</a></li>
<li><a href="#公司的成长">公司的成长</a></li>
</ul>
<!-- /MarkdownTOC -->


<h2 id="趋同性">趋同性</h2>
<ul>
<li>一群孩子结伙欺负你，并不是你做错了什么，而是因为这伙人需要找一件事一起干；</li>
<li>他们实际上并不恨你，他们只是需要一个共同的目标；</li>
<li>使用毒品基于同样的道理；</li>
<li>怪人使用毒品，是为了建立他们之间的社会纽带；</li>
<li>因为毒品是非法的，所以一起使用的话，就创造出一种共同的反叛感；</li>
</ul>
<h2 id="老员工与新人的关系">老员工与新人的关系</h2>
<ul>
<li>如果存在真正的外部能力测试，那么待在等级关系的底层也不会那么痛苦；
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2014-10/《黑客与画家》读书笔记/#more" class="more-link">阅读全文 &gt;</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  

<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-09-22T10:29:08.000Z"><a href="/2014-09/阅读underscore源码笔记/">2014 9月 22</a></time>
      
      
  
    <h1 class="title"><a href="/2014-09/阅读underscore源码笔记/">阅读underscore源码笔记</a></h1>
  

    </header>
    <div class="entry">
      
        <pre><code>本文为原创作品，可以转载，但请添加本文连接，谢谢传阅
</code></pre><p>underscorejs，一个实用的的Javascript函数库，值得推荐，<a href="http://underscorejs.org" target="_blank" rel="external">官网地址</a>，<a href="https://github.com/jashkenas/underscore" target="_blank" rel="external">Github仓库</a>，<a href="http://underscorejs.org/docs/underscore.html" target="_blank" rel="external">有注释的源码</a><br>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2014-09/阅读underscore源码笔记/#more" class="more-link">阅读全文 &gt;</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  

<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-09-18T03:34:33.000Z"><a href="/2014-09/如果你打算开始创业，我想告诉你的是…/">2014 9月 18</a></time>
      
      
  
    <h1 class="title"><a href="/2014-09/如果你打算开始创业，我想告诉你的是…/">如果你打算开始创业，我想告诉你的是…</a></h1>
  

    </header>
    <div class="entry">
      
        <p><img src="/img/20140918114126.jpg" alt="" title="成长需要坚持"><br>　　随着我的创业经历越来越丰富，有越来越多的人开始向我寻求创业的建议，比如“我该不该创业”、“我什么时候创业比较好”等等。对于这些问题，我的答案随着我经历的变化而不断变化。最开始，我会鼓励人们勇敢的去创业，但现在，我绝对不会再这样做了。</p>
<p>　　我喜欢做一个创业者。我深爱着我一手创办起来的公司，虽然这其中付出了很多艰辛。就算让我重来一百次，我也还是会选择这么做。所以，当我最开始被问到关于创业的建议时，我会说：“Just do it！创业是一件很美妙的事情，虽然很辛苦，但绝对值得。” 我这么说，是因为我对于人们有一些预判和假设，但后来事实证明这些假设都是错的。<br>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2014-09/如果你打算开始创业，我想告诉你的是…/#more" class="more-link">阅读全文 &gt;</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  

<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-09-15T03:14:41.000Z"><a href="/2014-09/Javascript秘密花园[摘录]/">2014 9月 15</a></time>
      
      
  
    <h1 class="title"><a href="/2014-09/Javascript秘密花园[摘录]/">Javascript秘密花园[摘录]</a></h1>
  

    </header>
    <div class="entry">
      
        <pre><code>本文来自网络，如有侵权请联系管理员
</code></pre><h2 id="目录">目录</h2>
<!-- MarkdownTOC -->

<ul>
<li><a href="#数组">数组</a><ul>
<li><a href="#遍历-方法">遍历 方法</a></li>
<li><a href="#length属性">length属性</a></li>
<li><a href="#array构造函数">Array构造函数</a></li>
</ul>
</li>
<li><a href="#类型">类型</a><ul>
<li><a href="#typeof操作符">typeof操作符</a></li>
<li><a href="#instanceof操作符">instanceof操作符</a></li>
</ul>
</li>
<li><a href="#undefined和null">undefined和null</a><ul>
<li><a href="#undefined的值">undefined的值</a></li>
<li><a href="#处理-undefined-值的改变">处理 undefined 值的改变</a></li>
<li><a href="#null-的用处">null 的用处</a></li>
</ul>
</li>
<li><a href="#其他">其他</a><ul>
<li><a href="#settimeout-和-setinterval">setTimeout 和 setInterval</a></li>
<li><a href="#setinterval-的堆调用">setInterval 的堆调用</a></li>
</ul>
</li>
</ul>
<!-- /MarkdownTOC -->

<h2 id="数组">数组</h2>
<h3 id="遍历_方法">遍历 方法</h3>
<p>为了达到遍历数组的最佳性能，推荐使用经典的 for 循环。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, ...... <span class="number">100000000</span>];</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>, l = list.length; i &lt; l; i++) {</div><div class="line">    <span class="built_in">console</span>.log(list[i]);</div><div class="line">}</div></pre></td></tr></table></figure>

<p>上面代码有一个处理，就是通过 l = list.length 来缓存数组的长度。<br>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2014-09/Javascript秘密花园[摘录]/#more" class="more-link">阅读全文 &gt;</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  

<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-08-28T06:58:16.000Z"><a href="/2014-08/一个亮点/">2014 8月 28</a></time>
      
      
  
    <h1 class="title"><a href="/2014-08/一个亮点/">一个亮点</a></h1>
  

    </header>
    <div class="entry">
      
        <pre><code>本文原创，尽情翻阅
</code></pre><p>今天项目中遇到一串数字，需要来格式化显示，示例如下<br>123456231显示为123,456,231<br>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2014-08/一个亮点/#more" class="more-link">阅读全文 &gt;</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  

<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-08-13T07:25:52.000Z"><a href="/2014-08/通过终端调试-AngularJS-应用/">2014 8月 13</a></time>
      
      
  
    <h1 class="title"><a href="/2014-08/通过终端调试-AngularJS-应用/">通过终端调试 AngularJS 应用</a></h1>
  

    </header>
    <div class="entry">
      
        <pre><code>本文来自网络，如有侵权请联系管理员
</code></pre><p>当我们构建AngularJS应用时，通过浏览器（如Chrome，Firefox和IE）的JavaScript控制台访问应用中隐藏的数据和服务总会有些困难。下面是一些简单的技巧可以帮助我们通过Javascript控制台来查看或者控制正在运行的Angular应用，使得应用可以比较容易进行测试，修改，甚至实时的修改我们的Angular应用：</p>
<p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2014-08/通过终端调试-AngularJS-应用/#more" class="more-link">阅读全文 &gt;</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  

<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-08-13T06:41:26.000Z"><a href="/2014-08/教你学编程：如何编写Nodejs插件/">2014 8月 13</a></time>
      
      
  
    <h1 class="title"><a href="/2014-08/教你学编程：如何编写Nodejs插件/">教你学编程：如何编写Node.js插件</a></h1>
  

    </header>
    <div class="entry">
      
        <pre><code>本文来自网络，如有侵权请联系管理员
</code></pre><p>Node.js在利用JavaScript编写后端方面效果拔群，值得我们多加尝试。不过如果大家需要一些无法直接使用的功能甚至是根本无从实现的模块使用，那么能否从C/C++库当中引入此类成果呢？答案是肯定的，大家要做的就是编写一款插件，并借此在自己的JavaScript代码中使用其它代码库的资源。下面我们就一同开始今天的探询之旅。</p>
<h2 id="介绍">介绍</h2>
<p>正如Node.js在官方说明文档中所言，插件是以动态方式进行链接的共享式对象，能够将JavaScript代码与C/C++库链接起来。这意味着我们可以引用任何来自C/C++库中的内容，并通过创建插件的方式将其纳入到Node.js当中。</p>
<p>作为实例，我们将为标准std::string对象创建一套封装。</p>
<p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2014-08/教你学编程：如何编写Nodejs插件/#more" class="more-link">阅读全文 &gt;</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>






<nav id="pagination">
  
  
    <a href="/page/2/" class="next"><span id="next">下一页</span></a>
  
  <div class="clearfix"></div>
</nav>
    
    </div></div>
    <div class="clearfix"></div>
  </div>
  
  <footer id="footer" class="inner"><div class="">
  
  &copy; 2014 jruif
  
 Powered by <a href='http://hexo.io'>Hexo</a>
</div>
<div class="clearfix"></div></footer>
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
<script src="http://libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.jruif.js"></script>

<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>

<script type="text/javascript" src="/vegas/jquery.vegas.js"></script>
<script type="text/javascript">
(function($){
	var elem = document.createElement('canvas');
	if(!(elem.getContext && elem.getContext('2d'))){
		alert("您的浏览器不支持HTML5，页面会错乱。请选择Chrome，Firefox，IE9+以获得更好的浏览体验。");
	}
	$("h1").jruif({
		rollingLinks: true
	});
	//请求bing印象图片
	var backg=(function(num,fadeTime){
	  		var bg=[];
	  		for(var i=0;i<num;i++){
	  			bg.push({
	  				"src":"http://toolsapp.sinaapp.com/bingwp.php?idx="+Math.floor(Math.random() * 15),
	  				"fade":fadeTime
	  			});
			}
			return bg;
	  	})(5,5000);
	//vegar插件
	$.vegas('slideshow',{
	  	delay: 60000,//多久换一幅图片
		backgrounds: backg
	})( 'overlay', {
		src:'/vegas/overlay.png',
		opacity:0.6
	});
	$('.fancybox').fancybox();
	$("#pagination a").on("click", function(){
		$(this).addClass("loading");
	});
})(jQuery);
(function(){
	var canvas=document.createElement("canvas");
	canvas.id="canvas";
	canvas.width=window.innerWidth;
	canvas.height=window.innerHeight;
	canvas.style.top="0";
	canvas.style.position="fixed";
	canvas.style.zIndex=-1;
	document.body.appendChild(canvas);
    var context=canvas.getContext("2d");
    // 
    // snow
    // 
    function snow(a){
        this.name="❅";
        this.init.apply(this,arguments);
    }
    snow.staticPro=function(){
        this.canvasWidth=canvas.width;
        this.canvasHeight=canvas.height;
        this.maxSize=30;
        this.minSize=5;
        this.maxSpeed=3;
        this.minSpeed=1;
        this.minWind=0;
        this.maxWind=0.5;
        this.maxRotate=Math.PI / 4;
        this.minRotate=Math.PI / 8;
        this.color="rgba(255,255,255,1)";
        this.run=function(sn){
            var self=this,removeSnow=[];
            setInterval(function(){
                context.clearRect(0,0,self.canvasWidth,self.canvasHeight-5);
                removeSnow.forEach(function(e){
                    self.snows.splice(e,1);
                    sn.splice(e,1);
                });
                removeSnow=[];
                self.snows.forEach(function(elm,i){
                    context.fillStyle=elm.color;
                    context.font=elm.size+"px sans-serif";
                    elm.y+=elm.speed;
                    elm.x+=Math.sin((elm.wind+=0.005)*Math.PI);
                    context.fillText("❅",elm.x,elm.y);
                    if(elm.y>self.canvasHeight+elm.size||elm.x>self.canvasWidth+elm.size||elm.x<0-elm.size){
                        removeSnow.push(i);
                    }
                });
            },300/6);
        }
    }
    snow.snows=[];
    snow.prototype={
        init:function(){
            snow.staticPro();
            this.size=this.rand(snow.maxSize,snow.minSize);
            this.speed=this.rand(snow.maxSpeed,snow.minSpeed);
            this.color=this.setOpacity();
            this.wind=this.rand(snow.maxWind,snow.minWind);
            this.rotate=this.rand(snow.maxRotate,snow.minRotate);
            this.x=Math.random()*snow.canvasWidth;
            this.y=-5;
            this.createSnow(this.x,this.y,this.size);
            snow.snows.push({
                x:this.x,
                y:this.y,
                color:this.color,
                speed:this.speed,
                size:this.size,
                wind:this.wind
            });
        },
        rand:function(a,b){
            return Math.round((b - a) * Math.random()) + a;
        },
        setOpacity: function() {
            var a = (this.size - snow.minSize) / (snow.maxSize - snow.minSize);
            var b = ((0.9 - 0.1) * a + 0.1).toFixed(2);
            return snow.color.replace(/\d+(?=\)$)/g,b);
        },
        createSnow:function(x,y,size){
            context.font=this.size+"px sans-serif";
            context.fillStyle=this.color;
            context.fillText(this.name,x,y,size);
        }
    }
    var handle2=(function(dots){
        var sn=[new snow()];
        snow.run(sn);
        window.setInterval(function(sn){
            for (var i = 0; i < 5; i++) {
                sn.push(new snow());
            };
        }.bind(window,sn), 1000);
    })();
})();
</script>

	
		<script type="text/javascript">
			(function(){
				var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
				document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F61148521014dfb85ac8907c77456806a' type='text/javascript'%3E%3C/script%3E"));
			})();
		</script>
	

</body>
</html>

